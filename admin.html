<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeBand - Admin Panel</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4f46e5;
            --secondary: #7c3aed;
            --success: #059669;
            --danger: #dc2626;
            --warning: #d97706;
            --info: #0891b2;
            --text-dark: #111827;
            --text-muted: #6b7280;
            --glass-border: rgba(0,0,0,0.1);
            --bg-page: #f1f5f9;
            --bg-card: #ffffff;
            --bg-sidebar: #ffffff;
            --sidebar-width: 270px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg-page); color: var(--text-dark); }

        /* â”€â”€â”€ Layout â”€â”€â”€ */
        .admin-wrapper { display: flex; min-height: 100vh; }

        /* â”€â”€â”€ Sidebar â”€â”€â”€ */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-sidebar);
            border-left: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            padding: 24px 16px;
            position: fixed;
            top: 0; right: 0; bottom: 0;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 4px 0 20px rgba(0,0,0,0.05);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 0 8px 24px;
            border-bottom: 2px solid #f3f4f6;
            margin-bottom: 20px;
        }
        .sidebar-logo .logo-icon {
            width: 44px; height: 44px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 22px;
        }
        .sidebar-logo h2 { font-size: 1.25rem; font-weight: 900; color: var(--primary); }
        .sidebar-logo span { font-size: 0.75rem; color: var(--text-muted); font-weight: 600; }

        .nav-section-title {
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 12px;
            margin: 16px 0 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            text-decoration: none;
            color: var(--text-dark);
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            border: none;
            background: transparent;
            width: 100%;
            text-align: right;
            transition: all 0.2s ease;
            position: relative;
        }
        .nav-item:hover { background: #f3f4f6; color: var(--primary); }
        .nav-item.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        .nav-item .nav-icon { font-size: 18px; min-width: 24px; text-align: center; }
        .nav-item .nav-badge {
            margin-right: auto;
            background: var(--danger);
            color: white;
            font-size: 0.7rem;
            padding: 2px 7px;
            border-radius: 20px;
            font-weight: 900;
        }

        .sidebar-footer {
            margin-top: auto;
            padding-top: 20px;
            border-top: 2px solid #f3f4f6;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* â”€â”€â”€ Main Content â”€â”€â”€ */
        .main-content {
            flex: 1;
            margin-right: var(--sidebar-width);
            padding: 30px;
            min-height: 100vh;
        }

        /* â”€â”€â”€ Top bar â”€â”€â”€ */
        .topbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        .topbar h1 {
            font-size: 1.8rem;
            font-weight: 900;
            color: #1e1b4b;
            border-bottom: 4px solid var(--primary);
            padding-bottom: 4px;
            display: inline-block;
        }
        .topbar-actions { display: flex; gap: 10px; align-items: center; }

        /* â”€â”€â”€ Section visibility â”€â”€â”€ */
        .section { display: none; }
        .section.active { display: block; }

        /* â”€â”€â”€ Stat Cards â”€â”€â”€ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            gap: 8px;
            transition: 0.3s;
        }
        .stat-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.08); }
        .stat-card .stat-icon {
            width: 48px; height: 48px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 22px;
            margin-bottom: 4px;
        }
        .stat-card .stat-value { font-size: 2rem; font-weight: 900; color: var(--text-dark); }
        .stat-card .stat-label { font-size: 0.9rem; color: var(--text-muted); font-weight: 600; }
        .stat-card .stat-change { font-size: 0.8rem; font-weight: 700; }
        .stat-change.up { color: var(--success); }
        .stat-change.down { color: var(--danger); }

        .icon-blue { background: #eff6ff; }
        .icon-green { background: #f0fdf4; }
        .icon-orange { background: #fff7ed; }
        .icon-purple { background: #faf5ff; }
        .icon-red { background: #fef2f2; }
        .icon-cyan { background: #ecfeff; }

        /* â”€â”€â”€ Charts Row â”€â”€â”€ */
        .charts-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .chart-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid #e5e7eb;
        }
        .chart-card h3 { font-size: 1rem; font-weight: 800; color: var(--text-dark); margin-bottom: 20px; }
        .bar-chart { display: flex; gap: 10px; align-items: flex-end; height: 120px; }
        .bar-col { display: flex; flex-direction: column; align-items: center; gap: 6px; flex: 1; }
        .bar { width: 100%; border-radius: 6px 6px 0 0; transition: 0.3s; cursor: pointer; }
        .bar:hover { filter: brightness(1.1); }
        .bar-label { font-size: 0.7rem; font-weight: 700; color: var(--text-muted); }

        .pie-chart-wrap { display: flex; align-items: center; gap: 20px; }
        .pie-visual {
            width: 100px; height: 100px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        .pie-legend { display: flex; flex-direction: column; gap: 8px; }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; font-weight: 700; }
        .legend-dot { width: 12px; height: 12px; border-radius: 50%; }

        /* â”€â”€â”€ Recent Activity â”€â”€â”€ */
        .activity-feed { display: flex; flex-direction: column; gap: 12px; }
        .activity-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 18px;
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }
        .activity-dot {
            width: 10px; height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        .activity-text { flex: 1; font-size: 0.9rem; font-weight: 600; }
        .activity-time { font-size: 0.8rem; color: var(--text-muted); font-weight: 600; }

        /* â”€â”€â”€ Report Card (keep existing) â”€â”€â”€ */
        .report-card {
            background: var(--bg-card);
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            transition: 0.3s;
        }
        .report-card:hover { transform: translateY(-3px); border-color: var(--primary); }
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #f3f4f6;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        .patient-name { font-size: 1.3rem; font-weight: 900; color: #1e1b4b; }
        .report-time { font-size: 0.9rem; color: #4b5563; font-weight: 600; margin-top: 4px; }
        .diagnosis-box {
            background: #f8fafc;
            padding: 18px;
            border-radius: 12px;
            border-right: 6px solid var(--primary);
            margin: 16px 0;
            color: var(--text-dark);
            font-size: 1rem;
            line-height: 1.7;
            font-weight: 500;
        }
        .diagnosis-box strong { color: #000; font-weight: 800; }
        .status-badge { padding: 7px 16px; border-radius: 30px; font-size: 0.85rem; font-weight: 900; }
        .status-pending { background: #ffedd5; color: #9a3412; }
        .status-done { background: #dcfce7; color: #166534; }
        .status-emergency { background: #fee2e2; color: #991b1b; }
        .action-btns { display: flex; gap: 10px; justify-content: flex-end; flex-wrap: wrap; }

        /* â”€â”€â”€ Table â”€â”€â”€ */
        .table-wrap {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid #e5e7eb;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 24px;
            border-bottom: 1px solid #f3f4f6;
        }
        .table-header h3 { font-weight: 800; font-size: 1rem; }
        table { width: 100%; border-collapse: collapse; }
        thead { background: #f9fafb; }
        th {
            padding: 12px 20px;
            text-align: right;
            font-size: 0.8rem;
            font-weight: 800;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid #f3f4f6;
        }
        td {
            padding: 14px 20px;
            font-size: 0.9rem;
            font-weight: 600;
            border-bottom: 1px solid #f9fafb;
            color: var(--text-dark);
        }
        tr:last-child td { border-bottom: none; }
        tr:hover td { background: #fafafa; }
        .user-avatar {
            width: 36px; height: 36px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 14px; font-weight: 900;
            flex-shrink: 0;
        }
        .user-cell { display: flex; align-items: center; gap: 10px; }

        /* â”€â”€â”€ Log item â”€â”€â”€ */
        .log-item {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            padding: 16px 20px;
            border-bottom: 1px solid #f3f4f6;
        }
        .log-item:last-child { border-bottom: none; }
        .log-type-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 800;
            white-space: nowrap;
        }
        .log-info { background: #eff6ff; color: #1d4ed8; }
        .log-warning { background: #fffbeb; color: #b45309; }
        .log-error { background: #fef2f2; color: #b91c1c; }
        .log-success { background: #f0fdf4; color: #166534; }
        .log-text { flex: 1; font-size: 0.9rem; font-weight: 600; line-height: 1.5; }
        .log-meta { font-size: 0.75rem; color: var(--text-muted); margin-top: 3px; font-weight: 600; }

        /* â”€â”€â”€ Forms / Inputs â”€â”€â”€ */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .form-group { display: flex; flex-direction: column; gap: 8px; }
        .form-group.full { grid-column: 1 / -1; }
        label { font-size: 0.85rem; font-weight: 800; color: var(--text-dark); }
        input, select, textarea {
            padding: 12px 14px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-family: 'Cairo', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-dark);
            background: #fff;
            transition: 0.2s;
            width: 100%;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79,70,229,0.1);
        }
        textarea { resize: vertical; min-height: 100px; }
        .search-bar {
            padding: 10px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-family: 'Cairo', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 240px;
            background: #f9fafb;
        }
        .search-bar:focus { outline: none; border-color: var(--primary); background: white; }

        /* â”€â”€â”€ Buttons â”€â”€â”€ */
        .btn {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-family: 'Cairo', sans-serif;
            font-weight: 800;
            font-size: 0.9rem;
            transition: 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .btn:hover { filter: brightness(1.08); transform: translateY(-1px); }
        .btn-primary { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-warning { background: var(--warning); color: white; }
        .btn-info { background: var(--info); color: white; }
        .btn-outline {
            background: transparent;
            border: 2px solid #e5e7eb;
            color: var(--text-dark);
        }
        .btn-outline:hover { border-color: var(--primary); color: var(--primary); background: rgba(79,70,229,0.05); }
        .btn-sm { padding: 6px 14px; font-size: 0.8rem; }
        .btn-icon {
            width: 36px; height: 36px;
            padding: 0;
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
        }

        /* â”€â”€â”€ Lang toggle â”€â”€â”€ */
        .lang-toggle {
            background: #f3f4f6;
            border: 2px solid #d1d5db;
            color: var(--text-dark);
            width: 46px; height: 46px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: 900;
            font-family: 'Cairo', sans-serif;
            font-size: 0.85rem;
            transition: 0.3s;
        }
        .lang-toggle:hover { border-color: var(--primary); color: var(--primary); }

        /* â”€â”€â”€ Alert / Notification pop â”€â”€â”€ */
        .toast-container {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .toast {
            padding: 14px 20px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.9rem;
            animation: slideIn 0.3s ease;
            max-width: 320px;
        }
        .toast-success { background: #dcfce7; color: #166534; border: 1px solid #bbf7d0; }
        .toast-error { background: #fee2e2; color: #991b1b; border: 1px solid #fecaca; }
        .toast-info { background: #eff6ff; color: #1d4ed8; border: 1px solid #bfdbfe; }
        @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* â”€â”€â”€ Settings â”€â”€â”€ */
        .settings-section {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid #e5e7eb;
            padding: 28px;
            margin-bottom: 20px;
        }
        .settings-section h3 {
            font-size: 1.1rem;
            font-weight: 900;
            color: #1e1b4b;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f3f4f6;
        }
        .toggle-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid #f9fafb;
        }
        .toggle-row:last-child { border-bottom: none; }
        .toggle-label { font-weight: 700; font-size: 0.95rem; }
        .toggle-desc { font-size: 0.8rem; color: var(--text-muted); margin-top: 2px; }
        .toggle-switch {
            position: relative;
            width: 48px; height: 26px;
            cursor: pointer;
        }
        .toggle-switch input { display: none; }
        .toggle-track {
            position: absolute;
            inset: 0;
            background: #d1d5db;
            border-radius: 13px;
            transition: 0.3s;
        }
        .toggle-track::after {
            content: '';
            position: absolute;
            width: 20px; height: 20px;
            background: white;
            border-radius: 50%;
            top: 3px; right: 3px;
            transition: 0.3s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .toggle-switch input:checked + .toggle-track { background: var(--primary); }
        .toggle-switch input:checked + .toggle-track::after { right: 25px; }

        /* â”€â”€â”€ Reward card â”€â”€â”€ */
        .reward-card {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid #e5e7eb;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 14px;
            transition: 0.2s;
        }
        .reward-card:hover { border-color: var(--primary); }
        .reward-icon { font-size: 32px; }
        .reward-info { flex: 1; }
        .reward-info h4 { font-weight: 800; font-size: 1rem; }
        .reward-info p { font-size: 0.85rem; color: var(--text-muted); font-weight: 600; margin-top: 3px; }
        .reward-points {
            font-size: 1.4rem;
            font-weight: 900;
            color: var(--primary);
        }

        /* â”€â”€â”€ Notification composer â”€â”€â”€ */
        .notif-type-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 16px; }
        .notif-type-btn {
            padding: 14px;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            background: white;
            cursor: pointer;
            text-align: center;
            font-family: 'Cairo', sans-serif;
            font-weight: 800;
            font-size: 0.9rem;
            transition: 0.2s;
        }
        .notif-type-btn:hover { border-color: var(--primary); color: var(--primary); }
        .notif-type-btn.selected { border-color: var(--primary); background: rgba(79,70,229,0.07); color: var(--primary); }
        .notif-type-btn .notif-emoji { font-size: 22px; display: block; margin-bottom: 6px; }

        /* â”€â”€â”€ Empty state â”€â”€â”€ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }
        .empty-state .empty-icon { font-size: 48px; margin-bottom: 14px; }
        .empty-state h3 { font-weight: 800; font-size: 1.1rem; margin-bottom: 6px; color: var(--text-dark); }
        .empty-state p { font-size: 0.9rem; }

        /* â”€â”€â”€ Volunteer card â”€â”€â”€ */
        .vol-card {
            background: var(--bg-card);
            border: 1px solid #e5e7eb;
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: 0.2s;
        }
        .vol-card:hover { border-color: var(--primary); }
        .vol-info { flex: 1; }
        .vol-info h4 { font-weight: 800; }
        .vol-info p { font-size: 0.85rem; color: var(--text-muted); font-weight: 600; margin-top: 3px; }

        /* â”€â”€â”€ Progress bar â”€â”€â”€ */
        .progress-bar-wrap { height: 8px; background: #f3f4f6; border-radius: 4px; overflow: hidden; }
        .progress-bar-fill { height: 100%; border-radius: 4px; transition: width 1s ease; }

        /* â”€â”€â”€ Tabs â”€â”€â”€ */
        .tabs { display: flex; gap: 4px; background: #f3f4f6; border-radius: 12px; padding: 4px; margin-bottom: 20px; }
        .tab-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 9px;
            background: transparent;
            font-family: 'Cairo', sans-serif;
            font-weight: 800;
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.2s;
            color: var(--text-muted);
        }
        .tab-btn.active { background: white; color: var(--primary); box-shadow: 0 2px 4px rgba(0,0,0,0.08); }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .main-content { margin-right: 0; padding: 16px; }
            .stats-grid { grid-template-columns: 1fr 1fr; }
            .charts-row { grid-template-columns: 1fr; }
            .form-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
<audio id="emergencySound" src="https://assets.mixkit.co/active_storage/sfx/951/951-preview.mp3" preload="auto"></audio>
<div id="toastContainer" class="toast-container"></div>

<div class="admin-wrapper">

    <!-- â”€â”€â”€ SIDEBAR â”€â”€â”€ -->
    <aside class="sidebar">
        <div class="sidebar-logo">
            <div class="logo-icon">ğŸ’™</div>
            <div>
                <h2>LifeBand</h2>
                <span data-i18n="adm_panel_sub">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</span>
            </div>
        </div>

        <span class="nav-section-title" data-i18n="nav_sec_main">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        <button class="nav-item active" onclick="showSection('dashboard')" data-section="dashboard">
            <span class="nav-icon">ğŸ“Š</span><span data-i18n="nav_dashboard">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</span>
        </button>

        <span class="nav-section-title" data-i18n="nav_sec_reports">Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</span>
        <button class="nav-item" onclick="showSection('reports')" data-section="reports">
            <span class="nav-icon">ğŸ“‹</span><span data-i18n="nav_reports">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</span>
            <span class="nav-badge" id="reportsBadge">0</span>
        </button>
        <button class="nav-item" onclick="showSection('emergency')" data-section="emergency">
            <span class="nav-icon">ğŸš¨</span><span data-i18n="nav_emergency">Ø³Ø¬Ù„ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</span>
        </button>
        <button class="nav-item" onclick="showSection('activitylogs')" data-section="activitylogs">
            <span class="nav-icon">ğŸ“œ</span><span data-i18n="nav_actlogs">Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</span>
        </button>

        <span class="nav-section-title" data-i18n="nav_sec_users">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</span>
        <button class="nav-item" onclick="showSection('users')" data-section="users">
            <span class="nav-icon">ğŸ‘¥</span><span data-i18n="nav_users">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
        </button>
        <button class="nav-item" onclick="showSection('volunteering')" data-section="volunteering">
            <span class="nav-icon">ğŸ¤</span><span data-i18n="nav_volunteering">Ø§Ù„ØªØ·ÙˆØ¹</span>
        </button>

        <span class="nav-section-title" data-i18n="nav_sec_system">Ø§Ù„Ù†Ø¸Ø§Ù…</span>
        <button class="nav-item" onclick="showSection('rewards')" data-section="rewards">
            <span class="nav-icon">ğŸ†</span><span data-i18n="nav_rewards">Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</span>
        </button>
        <button class="nav-item" onclick="showSection('notifications')" data-section="notifications">
            <span class="nav-icon">ğŸ“¢</span><span data-i18n="nav_notifs">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</span>
        </button>
        <button class="nav-item" onclick="showSection('settings')" data-section="settings">
            <span class="nav-icon">âš™ï¸</span><span data-i18n="nav_settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
        </button>

        <div class="sidebar-footer">
            <button class="lang-toggle" id="langBtn" onclick="toggleLang()">EN</button>
            <a href="index.html" class="btn btn-outline" style="text-align:center; justify-content:center;">
                ğŸ  <span data-i18n="nav_home">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </a>
        </div>
    </aside>

    <!-- â”€â”€â”€ MAIN CONTENT â”€â”€â”€ -->
    <main class="main-content">

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             1. DASHBOARD
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-dashboard" class="section active">
            <div class="topbar">
                <h1 data-i18n="nav_dashboard">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</h1>
                <div class="topbar-actions">
                    <span id="currentTime" style="font-weight:700; color:var(--text-muted); font-size:0.9rem;"></span>
                </div>
            </div>

            <div class="stats-grid" id="dashStats">
                <div class="stat-card">
                    <div class="stat-icon icon-blue">ğŸ‘¥</div>
                    <div class="stat-value" id="statUsers">â€”</div>
                    <div class="stat-label" data-i18n="stat_users">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</div>
                    <div class="stat-change up">â†‘ Ù†Ø´Ø·</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon icon-orange">ğŸ“‹</div>
                    <div class="stat-value" id="statReports">â€”</div>
                    <div class="stat-label" data-i18n="stat_reports">Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</div>
                    <div class="stat-change" id="statReportsChange">â€”</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon icon-red">ğŸš¨</div>
                    <div class="stat-value" id="statEmergency">â€”</div>
                    <div class="stat-label" data-i18n="stat_emergency">Ø­Ø§Ù„Ø§Øª Ø·Ø§Ø±Ø¦Ø©</div>
                    <div class="stat-change down" id="statEmerChange">â€”</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon icon-purple">ğŸ†</div>
                    <div class="stat-value" id="statRewards">â€”</div>
                    <div class="stat-label" data-i18n="stat_rewards">Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</div>
                    <div class="stat-change up">â†‘ Ù†Ø´Ø·</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon icon-green">ğŸ¤</div>
                    <div class="stat-value" id="statVol">â€”</div>
                    <div class="stat-label" data-i18n="stat_vol">Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙˆÙ†</div>
                    <div class="stat-change up">â†‘ Ù†Ø´Ø·</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon icon-cyan">ğŸ“œ</div>
                    <div class="stat-value" id="statLogs">â€”</div>
                    <div class="stat-label" data-i18n="stat_logs">Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                    <div class="stat-change up">â†‘ Ù†Ø´Ø·</div>
                </div>
            </div>

            <div class="charts-row">
                <div class="chart-card">
                    <h3 data-i18n="chart_reports_week">Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø®Ù„Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h3>
                    <div class="bar-chart" id="weekBarChart"></div>
                </div>
                <div class="chart-card">
                    <h3 data-i18n="chart_status_dist">ØªÙˆØ²ÙŠØ¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</h3>
                    <div class="pie-chart-wrap">
                        <div style="position:relative;width:100px;height:100px;">
                            <svg width="100" height="100" viewBox="0 0 100 100">
                                <circle cx="50" cy="50" r="40" fill="none" stroke="#f3f4f6" stroke-width="20"/>
                                <circle id="pieCompleted" cx="50" cy="50" r="40" fill="none" stroke="#059669" stroke-width="20"
                                    stroke-dasharray="0 251.2" stroke-dashoffset="62.8" transform="rotate(-90 50 50)"/>
                                <circle id="piePending" cx="50" cy="50" r="40" fill="none" stroke="#f59e0b" stroke-width="20"
                                    stroke-dasharray="0 251.2" stroke-dashoffset="62.8" transform="rotate(-90 50 50)"/>
                            </svg>
                            <div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:1rem;" id="pieCenterText">â€”</div>
                        </div>
                        <div class="pie-legend">
                            <div class="legend-item"><div class="legend-dot" style="background:#059669"></div><span data-i18n="status_done">ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</span></div>
                            <div class="legend-item"><div class="legend-dot" style="background:#f59e0b"></div><span data-i18n="status_pending">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</span></div>
                            <div class="legend-item"><div class="legend-dot" style="background:#dc2626"></div><span data-i18n="status_emergency_label">Ø·Ø§Ø±Ø¦</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="table-wrap">
                <div class="table-header">
                    <h3 data-i18n="dash_recent">Ø¢Ø®Ø± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h3>
                </div>
                <div style="padding:16px;" id="recentActivity">
                    <div class="empty-state"><div class="empty-icon">ğŸ“­</div><p data-i18n="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p></div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             2. REPORTS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-reports" class="section">
            <div class="topbar">
                <h1 data-i18n="nav_reports">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</h1>
                <div class="topbar-actions">
                    <input type="text" class="search-bar" id="reportsSearch" data-i18n-placeholder="search_placeholder" placeholder="Ø¨Ø­Ø«..." oninput="filterReports(this.value)">
                </div>
            </div>
            <div class="tabs">
                <button class="tab-btn active" onclick="filterByStatus('all', this)" data-i18n="tab_all">Ø§Ù„ÙƒÙ„</button>
                <button class="tab-btn" onclick="filterByStatus('pending', this)" data-i18n="tab_pending">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</button>
                <button class="tab-btn" onclick="filterByStatus('done', this)" data-i18n="tab_done">ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</button>
            </div>
            <div id="reportsList">
                <div class="empty-state"><div class="empty-icon">ğŸ“‹</div><p data-i18n="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p></div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             3. EMERGENCY LOGS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-emergency" class="section">
            <div class="topbar">
                <h1 data-i18n="nav_emergency">Ø³Ø¬Ù„ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</h1>
                <div class="topbar-actions">
                    <button class="btn btn-danger btn-sm" onclick="clearEmergencyLogs()" data-i18n="btn_clear_logs">Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button>
                </div>
            </div>
            <div class="table-wrap">
                <div id="emergencyLogs">
                    <div class="empty-state"><div class="empty-icon">ğŸš¨</div><p data-i18n="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p></div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             4. ACTIVITY LOGS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-activitylogs" class="section">
            <div class="topbar">
                <h1 data-i18n="nav_actlogs">Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h1>
                <div class="topbar-actions">
                    <select class="search-bar" style="min-width:160px;" id="logTypeFilter" onchange="filterLogs(this.value)">
                        <option value="all" data-i18n="tab_all">Ø§Ù„ÙƒÙ„</option>
                        <option value="login" data-i18n="log_type_login">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</option>
                        <option value="report" data-i18n="log_type_report">Ø¨Ù„Ø§Øº</option>
                        <option value="emergency" data-i18n="log_type_emergency">Ø·ÙˆØ§Ø±Ø¦</option>
                        <option value="admin" data-i18n="log_type_admin">Ø¥Ø¬Ø±Ø§Ø¡ Ø¥Ø¯Ø§Ø±Ø©</option>
                    </select>
                </div>
            </div>
            <div class="table-wrap" id="activityLogsList">
                <div class="empty-state"><div class="empty-icon">ğŸ“œ</div><p data-i18n="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p></div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             5. USER MANAGEMENT
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-users" class="section">
            <div class="topbar">
                <h1 data-i18n="nav_users">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h1>
                <div class="topbar-actions">
                    <input type="text" class="search-bar" id="userSearch" data-i18n-placeholder="search_placeholder" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…..." oninput="filterUsers(this.value)">
                </div>
            </div>
            <div class="table-wrap">
                <div class="table-header">
                    <h3 data-i18n="users_table_title">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                    <span id="usersCount" style="font-size:0.85rem;color:var(--text-muted);font-weight:700;"></span>
                </div>
                <div style="overflow-x:auto;">
                    <table id="usersTable">
                        <thead>
                            <tr>
                                <th data-i18n="th_name">Ø§Ù„Ø§Ø³Ù…</th>
                                <th data-i18n="th_email">Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
                                <th data-i18n="th_phone">Ø§Ù„Ù‡Ø§ØªÙ</th>
                                <th data-i18n="th_status">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th data-i18n="th_joined">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</th>
                                <th data-i18n="th_actions">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <tr><td colspan="6" style="text-align:center;padding:40px;color:var(--text-muted);" data-i18n="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             6. VOLUNTEERING
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-volunteering" class="section">
            <div class="topbar">
                <h1 data-i18n="nav_volunteering">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ·ÙˆØ¹</h1>
            </div>
            <div class="tabs">
                <button class="tab-btn active" onclick="filterVol('all', this)" data-i18n="tab_all">Ø§Ù„ÙƒÙ„</button>
                <button class="tab-btn" onclick="filterVol('pending', this)" data-i18n="tab_pending">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</button>
                <button class="tab-btn" onclick="filterVol('approved', this)" data-i18n="tab_approved">Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡</button>
                <button class="tab-btn" onclick="filterVol('rejected', this)" data-i18n="tab_rejected">Ù…Ø±ÙÙˆØ¶</button>
            </div>
            <div id="volunteeringList">
                <div class="empty-state"><div class="empty-icon">ğŸ¤</div><p data-i18n="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p></div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             7. REWARDS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-rewards" class="section">
            <div class="topbar">
                <h1 data-i18n="nav_rewards">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</h1>
                <div class="topbar-actions">
                    <button class="btn btn-primary btn-sm" onclick="openAddReward()" data-i18n="btn_add_reward">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØ§ÙØ£Ø©</button>
                </div>
            </div>

            <!-- Add Reward Form (hidden by default) -->
            <div id="addRewardForm" style="display:none; background:var(--bg-card); border:1px solid #e5e7eb; border-radius:16px; padding:24px; margin-bottom:20px;">
                <h3 style="font-weight:800; margin-bottom:20px;" data-i18n="form_add_reward">Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØ§ÙØ£Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label data-i18n="reward_name">Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©</label>
                        <input type="text" id="rewardName" data-i18n-placeholder="reward_name_ph" placeholder="Ù…Ø«Ø§Ù„: Ø¨Ø·Ù„ Ø§Ù„ÙŠÙˆÙ…">
                    </div>
                    <div class="form-group">
                        <label data-i18n="reward_points">Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                        <input type="number" id="rewardPoints" placeholder="500">
                    </div>
                    <div class="form-group">
                        <label data-i18n="reward_icon">Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©</label>
                        <input type="text" id="rewardIcon" placeholder="ğŸ…">
                    </div>
                    <div class="form-group">
                        <label data-i18n="reward_category">Ø§Ù„ÙØ¦Ø©</label>
                        <select id="rewardCategory">
                            <option value="health" data-i18n="cat_health">ØµØ­Ø©</option>
                            <option value="volunteer" data-i18n="cat_volunteer">ØªØ·ÙˆØ¹</option>
                            <option value="emergency" data-i18n="cat_emergency">Ø·ÙˆØ§Ø±Ø¦</option>
                        </select>
                    </div>
                    <div class="form-group full">
                        <label data-i18n="reward_desc">Ø§Ù„ÙˆØµÙ</label>
                        <textarea id="rewardDesc" data-i18n-placeholder="reward_desc_ph" placeholder="ÙˆØµÙ Ù‚ØµÙŠØ± Ù„Ù„Ù…ÙƒØ§ÙØ£Ø©"></textarea>
                    </div>
                </div>
                <div style="display:flex; gap:10px; margin-top:16px;">
                    <button class="btn btn-primary" onclick="saveReward()" data-i18n="btn_save">Ø­ÙØ¸</button>
                    <button class="btn btn-outline" onclick="document.getElementById('addRewardForm').style.display='none'" data-i18n="btn_cancel">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </div>

            <div id="rewardsList">
                <div class="empty-state"><div class="empty-icon">ğŸ†</div><p data-i18n="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p></div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             8. NOTIFICATIONS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-notifications" class="section">
            <div class="topbar">
                <h1 data-i18n="nav_notifs">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h1>
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
                <div style="background:var(--bg-card); border:1px solid #e5e7eb; border-radius:16px; padding:28px;">
                    <h3 style="font-weight:900; font-size:1.1rem; margin-bottom:20px;" data-i18n="notif_compose">Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø±</h3>

                    <div class="form-group" style="margin-bottom:16px;">
                        <label data-i18n="notif_type">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</label>
                        <div class="notif-type-grid">
                            <button class="notif-type-btn selected" onclick="selectNotifType('general', this)">
                                <span class="notif-emoji">ğŸ“¢</span>
                                <span data-i18n="notif_general">Ø¹Ø§Ù…</span>
                            </button>
                            <button class="notif-type-btn" onclick="selectNotifType('alert', this)">
                                <span class="notif-emoji">âš ï¸</span>
                                <span data-i18n="notif_alert">ØªÙ†Ø¨ÙŠÙ‡</span>
                            </button>
                            <button class="notif-type-btn" onclick="selectNotifType('reward', this)">
                                <span class="notif-emoji">ğŸ†</span>
                                <span data-i18n="notif_reward">Ù…ÙƒØ§ÙØ£Ø©</span>
                            </button>
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom:16px;">
                        <label data-i18n="notif_target">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰</label>
                        <select id="notifTarget">
                            <option value="all" data-i18n="target_all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</option>
                            <option value="volunteers" data-i18n="target_volunteers">Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙˆÙ†</option>
                            <option value="active" data-i18n="target_active">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†</option>
                        </select>
                    </div>

                    <div class="form-group" style="margin-bottom:16px;">
                        <label data-i18n="notif_title">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</label>
                        <input type="text" id="notifTitle" data-i18n-placeholder="notif_title_ph" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±">
                    </div>

                    <div class="form-group" style="margin-bottom:20px;">
                        <label data-i18n="notif_body">Ù†Øµ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</label>
                        <textarea id="notifBody" data-i18n-placeholder="notif_body_ph" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù‡Ù†Ø§..."></textarea>
                    </div>

                    <button class="btn btn-primary" style="width:100%;" onclick="sendNotification()" data-i18n="btn_send">
                        ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
                    </button>
                </div>

                <div>
                    <div style="background:var(--bg-card); border:1px solid #e5e7eb; border-radius:16px; padding:28px; margin-bottom:20px;">
                        <h3 style="font-weight:900; font-size:1.1rem; margin-bottom:16px;" data-i18n="notif_history">Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©</h3>
                        <div id="notifHistory">
                            <div class="empty-state"><div class="empty-icon">ğŸ“¬</div><p data-i18n="notif_none_sent">Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ø¹Ø¯</p></div>
                        </div>
                    </div>

                    <div style="background:linear-gradient(135deg,var(--primary),var(--secondary)); border-radius:16px; padding:28px; color:white;">
                        <h4 style="font-weight:900; font-size:1.1rem; margin-bottom:8px;" data-i18n="notif_tip_title">Ù†ØµÙŠØ­Ø©</h4>
                        <p style="font-size:0.9rem; opacity:0.9; font-weight:600; line-height:1.6;" data-i18n="notif_tip_body">
                            Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ø­ÙƒÙ…Ø©. Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…ØªÙƒØ±Ø±Ø© Ù‚Ø¯ ØªÙ‚Ù„Ù„ Ù…Ù† ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             9. SETTINGS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="sec-settings" class="section">
            <div class="topbar">
                <h1 data-i18n="nav_settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h1>
            </div>

            <div class="settings-section">
                <h3 data-i18n="settings_general">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø©</h3>
                <div class="toggle-row">
                    <div><div class="toggle-label" data-i18n="setting_sound">ØµÙˆØª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡</div><div class="toggle-desc" data-i18n="setting_sound_desc">ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø¨Ù„Ø§Øº Ø¬Ø¯ÙŠØ¯</div></div>
                    <label class="toggle-switch"><input type="checkbox" id="settingSound" checked onchange="saveSetting('sound', this.checked)"><div class="toggle-track"></div></label>
                </div>
                <div class="toggle-row">
                    <div><div class="toggle-label" data-i18n="setting_auto_refresh">Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</div><div class="toggle-desc" data-i18n="setting_auto_refresh_desc">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</div></div>
                    <label class="toggle-switch"><input type="checkbox" id="settingAutoRefresh" checked onchange="saveSetting('autoRefresh', this.checked)"><div class="toggle-track"></div></label>
                </div>
                <div class="toggle-row">
                    <div><div class="toggle-label" data-i18n="setting_notif_popup">Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØµÙØ­</div><div class="toggle-desc" data-i18n="setting_notif_popup_desc">Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØµÙØ­</div></div>
                    <label class="toggle-switch"><input type="checkbox" id="settingBrowserNotif" onchange="requestBrowserNotif(this.checked)"><div class="toggle-track"></div></label>
                </div>
            </div>

            <div class="settings-section">
                <h3 data-i18n="settings_admin">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label data-i18n="admin_name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±</label>
                        <input type="text" id="adminNameInput" value="Admin" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±">
                    </div>
                    <div class="form-group">
                        <label data-i18n="admin_email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" id="adminEmailInput" placeholder="admin@lifeband.com">
                    </div>
                </div>
                <div style="margin-top:16px;">
                    <button class="btn btn-primary" onclick="saveAdminInfo()" data-i18n="btn_save">Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</button>
                </div>
            </div>

            <div class="settings-section">
                <h3 data-i18n="settings_danger">Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø±</h3>
                <div class="toggle-row">
                    <div>
                        <div class="toggle-label" style="color:var(--danger);" data-i18n="setting_clear_reports">Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</div>
                        <div class="toggle-desc" data-i18n="setting_clear_reports_desc">Ø­Ø°Ù Ø¯Ø§Ø¦Ù… Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                    </div>
                    <button class="btn btn-danger btn-sm" onclick="clearAllReports()" data-i18n="btn_delete_all">Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>
                </div>
                <div class="toggle-row">
                    <div>
                        <div class="toggle-label" style="color:var(--danger);" data-i18n="setting_export">ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                        <div class="toggle-desc" data-i18n="setting_export_desc">ØªÙ†Ø²ÙŠÙ„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© JSON</div>
                    </div>
                    <button class="btn btn-outline btn-sm" onclick="exportData()" data-i18n="btn_export">ØªØµØ¯ÙŠØ±</button>
                </div>
            </div>
        </div>

    </main>
</div>

<!-- â”€â”€â”€ SCRIPTS â”€â”€â”€ -->
<script type="module">
import { db } from './js/firebase-config.js';
import { ref, onValue, update, remove, push, set, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRANSLATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const T = {
    ar: {
        adm_panel_sub: "Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",
        nav_sec_main: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
        nav_sec_reports: "Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª",
        nav_sec_users: "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†",
        nav_sec_system: "Ø§Ù„Ù†Ø¸Ø§Ù…",
        nav_dashboard: "Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
        nav_reports: "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª",
        nav_emergency: "Ø³Ø¬Ù„ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦",
        nav_actlogs: "Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª",
        nav_users: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",
        nav_volunteering: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ·ÙˆØ¹",
        nav_rewards: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª",
        nav_notifs: "Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
        nav_settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
        nav_home: "Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
        stat_users: "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†",
        stat_reports: "Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª",
        stat_emergency: "Ø­Ø§Ù„Ø§Øª Ø·Ø§Ø±Ø¦Ø©",
        stat_rewards: "Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª",
        stat_vol: "Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙˆÙ†",
        stat_logs: "Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ÙŠÙˆÙ…",
        chart_reports_week: "Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø®Ù„Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹",
        chart_status_dist: "ØªÙˆØ²ÙŠØ¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª",
        dash_recent: "Ø¢Ø®Ø± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª",
        tab_all: "Ø§Ù„ÙƒÙ„",
        tab_pending: "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
        tab_done: "ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡",
        tab_approved: "Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡",
        tab_rejected: "Ù…Ø±ÙÙˆØ¶",
        status_done: "ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡",
        status_pending: "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
        status_emergency_label: "Ø·Ø§Ø±Ø¦",
        adm_patient: "Ø§Ù„Ù…Ø±ÙŠØ¶",
        adm_time: "Ø§Ù„ØªÙˆÙ‚ÙŠØª",
        adm_diagnosis: "Ø§Ù„ØªØ´Ø®ÙŠØµ",
        adm_status: "Ø§Ù„Ø­Ø§Ù„Ø©",
        adm_btn_confirm: "ØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ø§Ù„Ø©",
        adm_btn_delete: "Ø­Ø°Ù",
        confirm_done: "Ù‡Ù„ ØªÙ… Ø§ØªØ®Ø§Ø° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø·Ø¨ÙŠ Ø§Ù„Ù„Ø§Ø²Ù…ØŸ",
        confirm_delete: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ",
        btn_clear_logs: "Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„",
        btn_add_reward: "+ Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØ§ÙØ£Ø©",
        btn_save: "Ø­ÙØ¸",
        btn_cancel: "Ø¥Ù„ØºØ§Ø¡",
        btn_send: "ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±",
        btn_delete_all: "Ø­Ø°Ù Ø§Ù„ÙƒÙ„",
        btn_export: "ØªØµØ¯ÙŠØ±",
        th_name: "Ø§Ù„Ø§Ø³Ù…",
        th_email: "Ø§Ù„Ø¨Ø±ÙŠØ¯",
        th_phone: "Ø§Ù„Ù‡Ø§ØªÙ",
        th_status: "Ø§Ù„Ø­Ø§Ù„Ø©",
        th_joined: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…",
        th_actions: "Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª",
        users_table_title: "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",
        user_active: "Ù†Ø´Ø·",
        user_inactive: "Ù…ÙˆÙ‚ÙˆÙ",
        btn_deactivate: "Ø¥ÙŠÙ‚Ø§Ù",
        btn_activate: "ØªÙØ¹ÙŠÙ„",
        form_add_reward: "Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØ§ÙØ£Ø© Ø¬Ø¯ÙŠØ¯Ø©",
        reward_name: "Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©",
        reward_points: "Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",
        reward_icon: "Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©",
        reward_category: "Ø§Ù„ÙØ¦Ø©",
        reward_desc: "Ø§Ù„ÙˆØµÙ",
        reward_name_ph: "Ù…Ø«Ø§Ù„: Ø¨Ø·Ù„ Ø§Ù„ÙŠÙˆÙ…",
        reward_desc_ph: "ÙˆØµÙ Ù‚ØµÙŠØ± Ù„Ù„Ù…ÙƒØ§ÙØ£Ø©",
        cat_health: "ØµØ­Ø©",
        cat_volunteer: "ØªØ·ÙˆØ¹",
        cat_emergency: "Ø·ÙˆØ§Ø±Ø¦",
        notif_compose: "Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø±",
        notif_type: "Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±",
        notif_general: "Ø¹Ø§Ù…",
        notif_alert: "ØªÙ†Ø¨ÙŠÙ‡",
        notif_reward: "Ù…ÙƒØ§ÙØ£Ø©",
        notif_target: "Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰",
        target_all: "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",
        target_volunteers: "Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙˆÙ†",
        target_active: "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†",
        notif_title: "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±",
        notif_body: "Ù†Øµ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±",
        notif_title_ph: "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±",
        notif_body_ph: "Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù‡Ù†Ø§...",
        notif_history: "Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©",
        notif_none_sent: "Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ø¹Ø¯",
        notif_tip_title: "Ù†ØµÙŠØ­Ø©",
        notif_tip_body: "Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ø­ÙƒÙ…Ø©. Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…ØªÙƒØ±Ø±Ø© Ù‚Ø¯ ØªÙ‚Ù„Ù„ Ù…Ù† ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†.",
        settings_general: "Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø©",
        settings_admin: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±",
        settings_danger: "Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø±",
        setting_sound: "ØµÙˆØª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡",
        setting_sound_desc: "ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø¨Ù„Ø§Øº Ø¬Ø¯ÙŠØ¯",
        setting_auto_refresh: "Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ",
        setting_auto_refresh_desc: "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹",
        setting_notif_popup: "Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØµÙØ­",
        setting_notif_popup_desc: "Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØµÙØ­",
        setting_clear_reports: "Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª",
        setting_clear_reports_desc: "Ø­Ø°Ù Ø¯Ø§Ø¦Ù… Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
        setting_export: "ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
        setting_export_desc: "ØªÙ†Ø²ÙŠÙ„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© JSON",
        admin_name: "Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±",
        admin_email: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
        search_placeholder: "Ø¨Ø­Ø«...",
        loading: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...",
        no_data: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª",
        toast_saved: "ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ âœ…",
        toast_deleted: "ØªÙ… Ø§Ù„Ø­Ø°Ù âœ…",
        toast_notif_sent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ğŸ“¤",
        toast_error: "Ø­Ø¯Ø« Ø®Ø·Ø£ âŒ",
        log_type_login: "ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„",
        log_type_report: "Ø¨Ù„Ø§Øº",
        log_type_emergency: "Ø·ÙˆØ§Ø±Ø¦",
        log_type_admin: "Ø¥Ø¬Ø±Ø§Ø¡ Ø¥Ø¯Ø§Ø±Ø©",
        vol_approve: "Ù‚Ø¨ÙˆÙ„",
        vol_reject: "Ø±ÙØ¶",
        pts: "Ù†Ù‚Ø·Ø©",
        lang_toggle: "EN"
    },
    en: {
        adm_panel_sub: "Admin Panel",
        nav_sec_main: "Main",
        nav_sec_reports: "Reports",
        nav_sec_users: "Users",
        nav_sec_system: "System",
        nav_dashboard: "Dashboard",
        nav_reports: "Reports List",
        nav_emergency: "Emergency Log",
        nav_actlogs: "Activity Logs",
        nav_users: "User Management",
        nav_volunteering: "Volunteering",
        nav_rewards: "Rewards",
        nav_notifs: "Send Notifications",
        nav_settings: "Settings",
        nav_home: "Back to Home",
        stat_users: "Users",
        stat_reports: "Reports",
        stat_emergency: "Emergencies",
        stat_rewards: "Rewards",
        stat_vol: "Volunteers",
        stat_logs: "Today's Activity",
        chart_reports_week: "Reports This Week",
        chart_status_dist: "Report Status Distribution",
        dash_recent: "Recent Activity",
        tab_all: "All",
        tab_pending: "Pending",
        tab_done: "Done",
        tab_approved: "Approved",
        tab_rejected: "Rejected",
        status_done: "Done",
        status_pending: "Pending",
        status_emergency_label: "Emergency",
        adm_patient: "Patient",
        adm_time: "Time",
        adm_diagnosis: "Diagnosis",
        adm_status: "Status",
        adm_btn_confirm: "Mark as Done",
        adm_btn_delete: "Delete",
        confirm_done: "Has medical action been taken?",
        confirm_delete: "Are you sure you want to delete this?",
        btn_clear_logs: "Clear Logs",
        btn_add_reward: "+ Add Reward",
        btn_save: "Save",
        btn_cancel: "Cancel",
        btn_send: "ğŸ“¤ Send Notification",
        btn_delete_all: "Delete All",
        btn_export: "Export",
        th_name: "Name",
        th_email: "Email",
        th_phone: "Phone",
        th_status: "Status",
        th_joined: "Joined",
        th_actions: "Actions",
        users_table_title: "All Users",
        user_active: "Active",
        user_inactive: "Suspended",
        btn_deactivate: "Suspend",
        btn_activate: "Activate",
        form_add_reward: "Add New Reward",
        reward_name: "Reward Name",
        reward_points: "Points Required",
        reward_icon: "Icon",
        reward_category: "Category",
        reward_desc: "Description",
        reward_name_ph: "e.g. Hero of the Day",
        reward_desc_ph: "Short reward description",
        cat_health: "Health",
        cat_volunteer: "Volunteer",
        cat_emergency: "Emergency",
        notif_compose: "Compose Notification",
        notif_type: "Notification Type",
        notif_general: "General",
        notif_alert: "Alert",
        notif_reward: "Reward",
        notif_target: "Send To",
        target_all: "All Users",
        target_volunteers: "Volunteers",
        target_active: "Active Users",
        notif_title: "Title",
        notif_body: "Message",
        notif_title_ph: "Notification title",
        notif_body_ph: "Write your message here...",
        notif_history: "Sent Notifications",
        notif_none_sent: "No notifications sent yet",
        notif_tip_title: "Tip",
        notif_tip_body: "Use notifications wisely. Too many alerts may reduce user engagement.",
        settings_general: "General Settings",
        settings_admin: "Admin Info",
        settings_danger: "Danger Zone",
        setting_sound: "Alert Sound",
        setting_sound_desc: "Play sound when a new report arrives",
        setting_auto_refresh: "Auto Refresh",
        setting_auto_refresh_desc: "Automatically update reports",
        setting_notif_popup: "Browser Notifications",
        setting_notif_popup_desc: "Allow browser push notifications",
        setting_clear_reports: "Delete All Reports",
        setting_clear_reports_desc: "Permanently delete all data",
        setting_export: "Export Data",
        setting_export_desc: "Download a JSON backup",
        admin_name: "Admin Name",
        admin_email: "Email Address",
        search_placeholder: "Search...",
        loading: "Loading...",
        no_data: "No data available",
        toast_saved: "Saved successfully âœ…",
        toast_deleted: "Deleted âœ…",
        toast_notif_sent: "Notification sent ğŸ“¤",
        toast_error: "An error occurred âŒ",
        log_type_login: "Login",
        log_type_report: "Report",
        log_type_emergency: "Emergency",
        log_type_admin: "Admin Action",
        vol_approve: "Approve",
        vol_reject: "Reject",
        pts: "pts",
        lang_toggle: "AR"
    }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let lang = localStorage.getItem('preferred_lang') || 'ar';
let currentSection = 'dashboard';
let reportsData = {};
let usersData = {};
let volunteeringData = {};
let rewardsData = {};
let emergencyData = {};
let activityLogs = JSON.parse(localStorage.getItem('activityLogs') || '[]');
let notifHistory = JSON.parse(localStorage.getItem('notifHistory') || '[]');
let currentNotifType = 'general';
let currentReportStatusFilter = 'all';
let currentVolFilter = 'all';
let settings = JSON.parse(localStorage.getItem('adminSettings') || '{"sound":true,"autoRefresh":true}');
let firstLoad = true;
let lastReportCount = 0;

const alertAudio = document.getElementById('emergencySound');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LANGUAGE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function t(key) { return T[lang][key] || key; }

function applyLang() {
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (T[lang][key]) el.innerText = T[lang][key];
    });
    document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (T[lang][key]) el.placeholder = T[lang][key];
    });
    document.getElementById('langBtn').innerText = T[lang]['lang_toggle'];
    localStorage.setItem('preferred_lang', lang);
}

window.toggleLang = function() {
    lang = lang === 'ar' ? 'en' : 'ar';
    applyLang();
    renderAll();
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.showSection = function(name) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById('sec-' + name).classList.add('active');
    document.querySelector(`[data-section="${name}"]`)?.classList.add('active');
    currentSection = name;
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CLOCK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateClock() {
    const el = document.getElementById('currentTime');
    if (el) el.innerText = new Date().toLocaleString(lang === 'ar' ? 'ar-SA' : 'en-US');
}
setInterval(updateClock, 1000);
updateClock();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg, type = 'success') {
    const c = document.getElementById('toastContainer');
    const d = document.createElement('div');
    d.className = `toast toast-${type}`;
    d.innerText = msg;
    c.appendChild(d);
    setTimeout(() => d.remove(), 3000);
}
window.showToast = showToast;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOG ACTIVITY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function logActivity(type, message, level = 'info') {
    activityLogs.unshift({ type, message, level, time: Date.now() });
    if (activityLogs.length > 200) activityLogs = activityLogs.slice(0, 200);
    localStorage.setItem('activityLogs', JSON.stringify(activityLogs));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FIREBASE LISTENERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
onValue(ref(db, 'reports'), snap => {
    reportsData = snap.exists() ? snap.val() : {};
    const count = Object.keys(reportsData).length;
    if (!firstLoad && count > lastReportCount) {
        if (settings.sound) alertAudio.play().catch(()=>{});
        logActivity('report', 'New report received', 'warning');
        showToast('ğŸ“‹ ' + (lang === 'ar' ? 'Ø¨Ù„Ø§Øº Ø¬Ø¯ÙŠØ¯ ÙˆØµÙ„!' : 'New report received!'), 'info');
    }
    lastReportCount = count;
    firstLoad = false;
    const badge = document.getElementById('reportsBadge');
    const pendingCount = Object.values(reportsData).filter(r => r.status !== 'ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡').length;
    badge.innerText = pendingCount;
    badge.style.display = pendingCount > 0 ? 'inline-block' : 'none';
    renderAll();
});

onValue(ref(db, 'users'), snap => {
    usersData = snap.exists() ? snap.val() : {};
    renderAll();
});

onValue(ref(db, 'volunteering'), snap => {
    volunteeringData = snap.exists() ? snap.val() : {};
    renderAll();
});

onValue(ref(db, 'rewards'), snap => {
    rewardsData = snap.exists() ? snap.val() : {};
    renderAll();
});

onValue(ref(db, 'emergency'), snap => {
    emergencyData = snap.exists() ? snap.val() : {};
    renderAll();
});

function renderAll() {
    renderDashboard();
    renderReports();
    renderEmergency();
    renderActivityLogs();
    renderUsers();
    renderVolunteering();
    renderRewards();
    renderNotifHistory();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDashboard() {
    const rKeys = Object.keys(reportsData);
    const uKeys = Object.keys(usersData);
    const vKeys = Object.keys(volunteeringData);
    const rwKeys = Object.keys(rewardsData);
    const eKeys = Object.keys(emergencyData);
    const pendingCount = rKeys.filter(k => reportsData[k].status !== 'ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡').length;

    document.getElementById('statUsers').innerText = uKeys.length || '0';
    document.getElementById('statReports').innerText = rKeys.length || '0';
    document.getElementById('statEmergency').innerText = eKeys.length || '0';
    document.getElementById('statRewards').innerText = rwKeys.length || '0';
    document.getElementById('statVol').innerText = vKeys.length || '0';
    document.getElementById('statLogs').innerText = activityLogs.filter(l => {
        const d = new Date(l.time); const n = new Date();
        return d.toDateString() === n.toDateString();
    }).length;

    const rChange = document.getElementById('statReportsChange');
    rChange.innerText = pendingCount > 0 ? `âš  ${pendingCount} ${lang === 'ar' ? 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±' : 'pending'}` : 'âœ“ ' + t('status_done');
    rChange.className = 'stat-change ' + (pendingCount > 0 ? 'down' : 'up');

    // Bar chart (last 7 days)
    const days = [];
    for (let i = 6; i >= 0; i--) {
        const d = new Date(); d.setDate(d.getDate() - i);
        const ds = d.toDateString();
        const count = rKeys.filter(k => new Date(reportsData[k].timestamp).toDateString() === ds).length;
        days.push({ label: d.toLocaleDateString(lang === 'ar' ? 'ar-SA' : 'en-US', { weekday: 'short' }), count });
    }
    const maxCount = Math.max(...days.map(d => d.count), 1);
    const barColors = ['#4f46e5','#7c3aed','#059669','#d97706','#0891b2','#dc2626','#4f46e5'];
    document.getElementById('weekBarChart').innerHTML = days.map((d, i) => `
        <div class="bar-col">
            <div class="bar" style="height:${Math.max(d.count/maxCount*90, 4)}px; background:${barColors[i]};" title="${d.count}"></div>
            <div class="bar-label">${d.label}</div>
        </div>`).join('');

    // Pie chart
    const done = rKeys.filter(k => reportsData[k].status === 'ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡').length;
    const total = rKeys.length || 1;
    const doneAngle = (done / total) * 251.2;
    const pendAngle = ((total - done) / total) * 251.2;
    document.getElementById('pieCompleted').setAttribute('stroke-dasharray', `${doneAngle} ${251.2 - doneAngle}`);
    document.getElementById('piePending').setAttribute('stroke-dasharray', `${pendAngle} ${251.2 - pendAngle}`);
    document.getElementById('piePending').setAttribute('stroke-dashoffset', `${62.8 - doneAngle}`);
    document.getElementById('pieCenterText').innerText = total;

    // Recent activity
    const recent = activityLogs.slice(0, 8);
    const ra = document.getElementById('recentActivity');
    if (recent.length === 0) {
        ra.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ“­</div><p>${t('no_data')}</p></div>`;
        return;
    }
    const levelColors = { info: '#4f46e5', warning: '#d97706', error: '#dc2626', success: '#059669' };
    ra.innerHTML = `<div class="activity-feed">${recent.map(l => `
        <div class="activity-item">
            <div class="activity-dot" style="background:${levelColors[l.level] || '#4f46e5'}"></div>
            <div class="activity-text">${l.message}</div>
            <div class="activity-time">${new Date(l.time).toLocaleTimeString(lang === 'ar' ? 'ar-SA' : 'en-US')}</div>
        </div>`).join('')}</div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REPORTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderReports(search = '', statusFilter = currentReportStatusFilter) {
    const list = document.getElementById('reportsList');
    let keys = Object.keys(reportsData).reverse();
    if (statusFilter === 'pending') keys = keys.filter(k => reportsData[k].status !== 'ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡');
    if (statusFilter === 'done') keys = keys.filter(k => reportsData[k].status === 'ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡');
    if (search) keys = keys.filter(k => reportsData[k].patientName?.toLowerCase().includes(search.toLowerCase()) || reportsData[k].diagnosis?.toLowerCase().includes(search.toLowerCase()));

    if (keys.length === 0) {
        list.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ“‹</div><h3>${t('no_data')}</h3></div>`;
        return;
    }
    list.innerHTML = keys.map(key => {
        const r = reportsData[key];
        const date = new Date(r.timestamp).toLocaleString(lang === 'ar' ? 'ar-SA' : 'en-US');
        const isDone = r.status === 'ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡';
        return `<div class="report-card">
            <div class="report-header">
                <div>
                    <div class="patient-name">${t('adm_patient')}: ${r.patientName}</div>
                    <div class="report-time">${t('adm_time')}: ${date}</div>
                </div>
                <span class="status-badge ${isDone ? 'status-done' : 'status-pending'}">${isDone ? t('status_done') : t('status_pending')}</span>
            </div>
            <div class="diagnosis-box"><strong>${t('adm_diagnosis')}:</strong><br>${r.diagnosis}</div>
            <div class="action-btns">
                ${!isDone ? `<button onclick="markAsDone('${key}')" class="btn btn-success">${t('adm_btn_confirm')}</button>` : ''}
                <button onclick="deleteReport('${key}')" class="btn btn-danger">${t('adm_btn_delete')}</button>
            </div>
        </div>`;
    }).join('');
}

window.filterReports = (v) => renderReports(v, currentReportStatusFilter);
window.filterByStatus = (status, btn) => {
    currentReportStatusFilter = status;
    document.querySelectorAll('#sec-reports .tab-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    renderReports(document.getElementById('reportsSearch').value, status);
};

window.markAsDone = async (id) => {
    if (confirm(t('confirm_done'))) {
        await update(ref(db, `reports/${id}`), { status: "ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡" });
        logActivity('admin', lang === 'ar' ? `ØªÙ… ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© "ØªÙ… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡" Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù„Ø§Øº ${id}` : `Report ${id} marked as done`, 'success');
        showToast(t('toast_saved'));
    }
};

window.deleteReport = async (id) => {
    if (confirm(t('confirm_delete'))) {
        await remove(ref(db, `reports/${id}`));
        logActivity('admin', lang === 'ar' ? `ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨Ù„Ø§Øº ${id}` : `Report ${id} deleted`, 'warning');
        showToast(t('toast_deleted'));
    }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EMERGENCY LOGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderEmergency() {
    const el = document.getElementById('emergencyLogs');
    const keys = Object.keys(emergencyData).reverse();
    if (keys.length === 0) {
        const storedEmerg = activityLogs.filter(l => l.type === 'emergency');
        if (storedEmerg.length === 0) {
            el.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸš¨</div><h3>${t('no_data')}</h3></div>`;
            return;
        }
        el.innerHTML = storedEmerg.map(l => `
            <div class="log-item">
                <span class="log-type-badge log-error">ğŸš¨ ${t('log_type_emergency')}</span>
                <div class="log-text">${l.message}<div class="log-meta">${new Date(l.time).toLocaleString(lang === 'ar' ? 'ar-SA' : 'en-US')}</div></div>
            </div>`).join('');
        return;
    }
    el.innerHTML = keys.map(k => {
        const e = emergencyData[k];
        const date = e.timestamp ? new Date(e.timestamp).toLocaleString(lang === 'ar' ? 'ar-SA' : 'en-US') : 'â€”';
        return `<div class="log-item">
            <span class="log-type-badge log-error">ğŸš¨ ${t('log_type_emergency')}</span>
            <div class="log-text">
                <strong>${e.patientName || e.user || 'â€”'}</strong> â€” ${e.message || e.description || e.type || 'â€”'}
                <div class="log-meta">${date}</div>
            </div>
            <button onclick="deleteEmergency('${k}')" class="btn btn-outline btn-sm btn-icon">ğŸ—‘</button>
        </div>`;
    }).join('');
}

window.deleteEmergency = async (id) => {
    if (confirm(t('confirm_delete'))) {
        await remove(ref(db, `emergency/${id}`));
        showToast(t('toast_deleted'));
    }
};

window.clearEmergencyLogs = async () => {
    if (confirm(t('confirm_delete'))) {
        await remove(ref(db, 'emergency'));
        activityLogs = activityLogs.filter(l => l.type !== 'emergency');
        localStorage.setItem('activityLogs', JSON.stringify(activityLogs));
        showToast(t('toast_deleted'));
    }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACTIVITY LOGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderActivityLogs(typeFilter = 'all') {
    const el = document.getElementById('activityLogsList');
    let logs = activityLogs;
    if (typeFilter !== 'all') logs = logs.filter(l => l.type === typeFilter);
    if (logs.length === 0) {
        el.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ“œ</div><h3>${t('no_data')}</h3></div>`;
        return;
    }
    const levelMap = { info: 'log-info', warning: 'log-warning', error: 'log-error', success: 'log-success' };
    el.innerHTML = logs.map(l => `
        <div class="log-item">
            <span class="log-type-badge ${levelMap[l.level] || 'log-info'}">${getLogTypeLabel(l.type)}</span>
            <div class="log-text">${l.message}<div class="log-meta">${new Date(l.time).toLocaleString(lang === 'ar' ? 'ar-SA' : 'en-US')}</div></div>
        </div>`).join('');
}

function getLogTypeLabel(type) {
    const map = { login: t('log_type_login'), report: t('log_type_report'), emergency: t('log_type_emergency'), admin: t('log_type_admin') };
    return map[type] || type;
}

window.filterLogs = (v) => renderActivityLogs(v);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// USERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderUsers(search = '') {
    const tbody = document.getElementById('usersTableBody');
    let keys = Object.keys(usersData);
    if (search) keys = keys.filter(k => {
        const u = usersData[k];
        return u.name?.toLowerCase().includes(search.toLowerCase()) || u.email?.toLowerCase().includes(search.toLowerCase());
    });
    document.getElementById('usersCount').innerText = `${keys.length} ${lang === 'ar' ? 'Ù…Ø³ØªØ®Ø¯Ù…' : 'users'}`;
    if (keys.length === 0) {
        tbody.innerHTML = `<tr><td colspan="6" style="text-align:center;padding:40px;color:var(--text-muted);">${t('no_data')}</td></tr>`;
        return;
    }
    const colors = ['#4f46e5','#059669','#d97706','#dc2626','#0891b2','#7c3aed'];
    tbody.innerHTML = keys.map((k, i) => {
        const u = usersData[k];
        const isActive = u.status !== 'inactive';
        const date = u.createdAt ? new Date(u.createdAt).toLocaleDateString(lang === 'ar' ? 'ar-SA' : 'en-US') : 'â€”';
        const initials = (u.name || 'U').slice(0, 2).toUpperCase();
        const color = colors[i % colors.length];
        return `<tr>
            <td><div class="user-cell">
                <div class="user-avatar" style="background:${color}20;color:${color}">${initials}</div>
                <span>${u.name || 'â€”'}</span>
            </div></td>
            <td>${u.email || 'â€”'}</td>
            <td>${u.phone || 'â€”'}</td>
            <td><span class="status-badge ${isActive ? 'status-done' : 'status-pending'}">${isActive ? t('user_active') : t('user_inactive')}</span></td>
            <td>${date}</td>
            <td>
                <div style="display:flex;gap:6px;">
                    <button onclick="toggleUser('${k}', ${isActive})" class="btn btn-sm ${isActive ? 'btn-warning' : 'btn-success'}">${isActive ? t('btn_deactivate') : t('btn_activate')}</button>
                    <button onclick="deleteUser('${k}')" class="btn btn-sm btn-danger btn-icon">ğŸ—‘</button>
                </div>
            </td>
        </tr>`;
    }).join('');
}

window.filterUsers = (v) => renderUsers(v);
window.toggleUser = async (id, isActive) => {
    await update(ref(db, `users/${id}`), { status: isActive ? 'inactive' : 'active' });
    logActivity('admin', `User ${id} ${isActive ? 'suspended' : 'activated'}`, 'info');
    showToast(t('toast_saved'));
};
window.deleteUser = async (id) => {
    if (confirm(t('confirm_delete'))) {
        await remove(ref(db, `users/${id}`));
        logActivity('admin', `User ${id} deleted`, 'warning');
        showToast(t('toast_deleted'));
    }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// VOLUNTEERING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderVolunteering(filter = currentVolFilter) {
    const el = document.getElementById('volunteeringList');
    let keys = Object.keys(volunteeringData);
    if (filter !== 'all') keys = keys.filter(k => volunteeringData[k].status === filter);
    if (keys.length === 0) {
        el.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ¤</div><h3>${t('no_data')}</h3></div>`;
        return;
    }
    el.innerHTML = keys.map(k => {
        const v = volunteeringData[k];
        const isPending = !v.status || v.status === 'pending';
        const date = v.timestamp ? new Date(v.timestamp).toLocaleDateString(lang === 'ar' ? 'ar-SA' : 'en-US') : 'â€”';
        return `<div class="vol-card">
            <div style="font-size:32px;">ğŸ¤</div>
            <div class="vol-info">
                <h4>${v.name || v.userName || 'â€”'}</h4>
                <p>${v.specialty || v.field || 'â€”'} â€¢ ${date}</p>
                ${v.message ? `<p style="margin-top:6px;">${v.message}</p>` : ''}
            </div>
            <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end;">
                <span class="status-badge ${v.status === 'approved' ? 'status-done' : v.status === 'rejected' ? 'status-pending' : 'status-pending'}">${v.status === 'approved' ? t('tab_approved') : v.status === 'rejected' ? t('tab_rejected') : t('tab_pending')}</span>
                ${isPending ? `
                <div style="display:flex;gap:6px;">
                    <button onclick="approveVol('${k}')" class="btn btn-success btn-sm">${t('vol_approve')}</button>
                    <button onclick="rejectVol('${k}')" class="btn btn-danger btn-sm">${t('vol_reject')}</button>
                </div>` : ''}
            </div>
        </div>`;
    }).join('');
}

window.filterVol = (f, btn) => {
    currentVolFilter = f;
    document.querySelectorAll('#sec-volunteering .tab-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    renderVolunteering(f);
};
window.approveVol = async (id) => {
    await update(ref(db, `volunteering/${id}`), { status: 'approved' });
    logActivity('admin', `Volunteering request ${id} approved`, 'success');
    showToast(t('toast_saved'));
};
window.rejectVol = async (id) => {
    await update(ref(db, `volunteering/${id}`), { status: 'rejected' });
    logActivity('admin', `Volunteering request ${id} rejected`, 'warning');
    showToast(t('toast_saved'));
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REWARDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderRewards() {
    const el = document.getElementById('rewardsList');
    const keys = Object.keys(rewardsData);
    if (keys.length === 0) {
        el.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ†</div><h3>${t('no_data')}</h3><p>${lang === 'ar' ? 'Ø£Ø¶Ù Ø£ÙˆÙ„ Ù…ÙƒØ§ÙØ£Ø©!' : 'Add your first reward!'}</p></div>`;
        return;
    }
    el.innerHTML = keys.map(k => {
        const r = rewardsData[k];
        return `<div class="reward-card">
            <div class="reward-icon">${r.icon || 'ğŸ…'}</div>
            <div class="reward-info">
                <h4>${r.name || 'â€”'}</h4>
                <p>${r.description || ''}</p>
                <span class="status-badge status-done" style="font-size:0.75rem;padding:4px 10px;">${r.category || 'â€”'}</span>
            </div>
            <div class="reward-points">${r.points || 0} <span style="font-size:0.9rem;">${t('pts')}</span></div>
            <button onclick="deleteReward('${k}')" class="btn btn-outline btn-sm btn-icon">ğŸ—‘</button>
        </div>`;
    }).join('');
}

window.openAddReward = () => {
    const f = document.getElementById('addRewardForm');
    f.style.display = f.style.display === 'none' ? 'block' : 'none';
};

window.saveReward = async () => {
    const name = document.getElementById('rewardName').value.trim();
    const points = parseInt(document.getElementById('rewardPoints').value) || 0;
    const icon = document.getElementById('rewardIcon').value.trim() || 'ğŸ…';
    const category = document.getElementById('rewardCategory').value;
    const description = document.getElementById('rewardDesc').value.trim();
    if (!name) { showToast(t('toast_error'), 'error'); return; }
    await push(ref(db, 'rewards'), { name, points, icon, category, description, createdAt: Date.now() });
    logActivity('admin', `New reward added: ${name}`, 'success');
    showToast(t('toast_saved'));
    document.getElementById('addRewardForm').style.display = 'none';
    ['rewardName','rewardPoints','rewardIcon','rewardDesc'].forEach(id => document.getElementById(id).value = '');
};

window.deleteReward = async (id) => {
    if (confirm(t('confirm_delete'))) {
        await remove(ref(db, `rewards/${id}`));
        showToast(t('toast_deleted'));
    }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NOTIFICATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.selectNotifType = (type, btn) => {
    currentNotifType = type;
    document.querySelectorAll('.notif-type-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
};

window.sendNotification = async () => {
    const title = document.getElementById('notifTitle').value.trim();
    const body = document.getElementById('notifBody').value.trim();
    const target = document.getElementById('notifTarget').value;
    if (!title || !body) { showToast(t('toast_error'), 'error'); return; }
    const notif = { title, body, type: currentNotifType, target, sentAt: Date.now() };
    await push(ref(db, 'notifications'), notif);
    notifHistory.unshift(notif);
    localStorage.setItem('notifHistory', JSON.stringify(notifHistory));
    logActivity('admin', `Notification sent: "${title}"`, 'info');
    showToast(t('toast_notif_sent'));
    document.getElementById('notifTitle').value = '';
    document.getElementById('notifBody').value = '';
    renderNotifHistory();
};

function renderNotifHistory() {
    const el = document.getElementById('notifHistory');
    if (notifHistory.length === 0) {
        el.innerHTML = `<div class="empty-state" style="padding:30px 20px;"><div class="empty-icon">ğŸ“¬</div><p>${t('notif_none_sent')}</p></div>`;
        return;
    }
    el.innerHTML = notifHistory.slice(0, 5).map(n => `
        <div class="log-item">
            <span class="log-type-badge log-info">${n.type === 'alert' ? 'âš ï¸' : n.type === 'reward' ? 'ğŸ†' : 'ğŸ“¢'}</span>
            <div class="log-text"><strong>${n.title}</strong><div class="log-meta">${n.body.slice(0, 60)}${n.body.length > 60 ? '...' : ''} â€¢ ${new Date(n.sentAt).toLocaleDateString(lang === 'ar' ? 'ar-SA' : 'en-US')}</div></div>
        </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SETTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.saveSetting = (key, val) => {
    settings[key] = val;
    localStorage.setItem('adminSettings', JSON.stringify(settings));
    showToast(t('toast_saved'));
};

window.requestBrowserNotif = (val) => {
    if (val && Notification.permission !== 'granted') {
        Notification.requestPermission().then(p => {
            document.getElementById('settingBrowserNotif').checked = p === 'granted';
            saveSetting('browserNotif', p === 'granted');
        });
    } else saveSetting('browserNotif', val);
};

window.saveAdminInfo = () => {
    const name = document.getElementById('adminNameInput').value;
    const email = document.getElementById('adminEmailInput').value;
    localStorage.setItem('adminInfo', JSON.stringify({ name, email }));
    showToast(t('toast_saved'));
};

window.clearAllReports = async () => {
    if (confirm(t('confirm_delete'))) {
        await remove(ref(db, 'reports'));
        logActivity('admin', 'All reports cleared', 'error');
        showToast(t('toast_deleted'));
    }
};

window.exportData = async () => {
    const data = { reports: reportsData, users: usersData, volunteering: volunteeringData, rewards: rewardsData, activityLogs, exportedAt: new Date().toISOString() };
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `lifeband-backup-${new Date().toLocaleDateString('en-US').replace(/\//g,'-')}.json`;
    a.click();
    logActivity('admin', 'Data exported', 'info');
    showToast(t('toast_saved'));
};

// Load settings
function loadSettings() {
    document.getElementById('settingSound').checked = settings.sound !== false;
    document.getElementById('settingAutoRefresh').checked = settings.autoRefresh !== false;
    document.getElementById('settingBrowserNotif').checked = settings.browserNotif === true;
    const info = JSON.parse(localStorage.getItem('adminInfo') || '{}');
    if (info.name) document.getElementById('adminNameInput').value = info.name;
    if (info.email) document.getElementById('adminEmailInput').value = info.email;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
logActivity('login', lang === 'ar' ? 'ØªÙ… ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©' : 'Admin panel opened', 'info');
applyLang();
loadSettings();
renderNotifHistory();

</script>
</body>
</html>
