<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø·Ø¨ÙŠ - LifeBand</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .profile-container { display: flex; justify-content: center; align-items: center; min-height: 80vh; }
        .medical-card { background: var(--card-bg); padding: 30px; border-radius: 25px; border: 1px solid var(--border); width: 100%; max-width: 400px; text-align: center; }
        .blood-tag { background: #ff4757; color: white; padding: 5px 15px; border-radius: 10px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <header class="navbar-modern">
            <div class="nav-links"><a href="index.html" class="nav-item">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></div>
            <div class="nav-brand">LifeBand</div>
        </header>

        <main class="profile-container">
            <div class="medical-card">
                <img src="https://cdn-icons-png.flaticon.com/512/3774/3774299.png" width="80" alt="user">
                <h2 id="userName" style="color: var(--accent); margin-top: 15px;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h2>
                <hr style="border: 0.5px solid var(--border); margin: 20px 0;">
                <div style="text-align: right;">
                    <p><strong>ğŸ©¸ ÙØµÙŠÙ„Ø© Ø§Ù„Ø¯Ù…:</strong> <span id="userBlood" class="blood-tag">--</span></p>
                    <p><strong>ğŸ“‹ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©:</strong></p>
                    <p id="userCondition" style="color: var(--text-muted); background: rgba(0,0,0,0.05); padding: 10px; border-radius: 10px;">--</p>
                </div>
                <p style="font-size: 11px; color: var(--accent); margin-top: 20px;">Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…Ø±ØªØ¨Ø· Ø¨ØªÙ‚Ù†ÙŠØ© NFC Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ LifeBand</p>
            </div>
        </main>
    </div>

    <script type="module">
        import { db } from './js/firebase-config.js';
        import { ref, get, child } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const params = new URLSearchParams(window.location.search);
        const userId = params.get('id');

        if (userId) {
            const dbRef = ref(db);
            get(child(dbRef, `patients/${userId}`)).then((snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    document.getElementById('userName').innerText = data.name;
                    document.getElementById('userBlood').innerText = data.bloodType;
                    document.getElementById('userCondition').innerText = data.conditions;
                } else {
                    document.getElementById('userName').innerText = "Ø§Ù„Ù…Ø±ÙŠØ¶ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯";
                }
            }).catch((error) => {
                console.error(error);
                document.getElementById('userName').innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„";
            });
        } else {
            document.getElementById('userName').innerText = "Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­";
        }
    </script>
</body>
</html>